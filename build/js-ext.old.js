#!/usr/bin/env node
!function(){function n(n){if(f[n])return f[n];throw"Not found: "+n}function i(f){var e=n(f);e._d||(e._a=1,e.g&&e.g().forEach(function(e){if("@"!=e[0]){if(n(e)._a)throw"Cycle: "+f+", "+e;n(e)._d||i(e)}}),e.v&&e.v(),e.i&&e.i(),e._d=1,delete e._a)}var f={},e=GLOBAL;e.__m=function(o,t){if(t)f[o]=t();else{for(o in f)n(o).g&&n(o).s(n(o).g().map(function(i){return n("@"==i[0]?i.slice(1):i).e||{}}));for(o in f)i(o);delete e.__m}}}();
Object.extend=function(){for(var e={},_=0;_<arguments.length;_++)for(var t in arguments[_]){(e.__lookupGetter__(t)||e.__lookupSetter__(t))&&delete e[t],e[t]=arguments[_][t];var r=arguments[_].__lookupGetter__(t);r&&e.__defineGetter__(t,r);var n=arguments[_].__lookupSetter__(t);n&&e.__defineSetter__(t,n)}return e};
!function(r){function t(r,t){for(var n,u=0;u<r.length;u++)r[u]=null!=(n=e.exec(r[u]))?t[Number(n[1])]:r[u].replace(/\0/g,",");return r}function n(r,t){if(t=Number(t),isNaN(t))return r;r=""+r;var n=Math.abs(t)-r.length;if(0>=n)return r;for(;i.length<n;)i+=i;return 0>t?r+i.substring(0,n):i.substring(0,n)+r}r.format=function(){if(0==arguments.length)return this;var r=/\{(\d+)(?:,([-+]?\d+))?(?:\:([^(^}]+)(?:\(((?:\\\)|[^)])+)\)){0,1}){0,1}\}/g,e=arguments;return this.replace(r,function(r,i,a,l,f){return r=e[Number(i)],l=u[l],n(null==l?r:l(r,t((f||"").replace(/\\\)/g,")").replace(/\\,/g,"\x00").split(","),e)),a)})},String.format=function(t){return arguments.length<=1?t:r.format.apply(t,Array.prototype.slice.call(arguments,1))},r.format.add=function(r,t,n){if(null!=u[r]&&!n)throw"Format "+r+" exist, use replace=true for replace";u[r]=t},String.format.init=r.format.init=function(r){var t;for(var n in r)t=u[n],null!=t&&null!=t.init&&t.init(r[n])},r.format.get=function(r){return u[r]};var e=/^\{(\d+)\}$/,u={},i="    ";r.format.add("arr",function(r,t){if(null==r)return"null";var n=[],e=t.shift()||"",i=u[t.shift()];if(null==i)n=r;else for(var a=0;a<r.length;a++)n.push(i(r[a],t));return n.join(e)}),r.format.add("obj",function(r,t){return r[t]})}(String.prototype);
String.prototype.format.add("@",function(t,r){return t[r[0].toLowerCase().replace(/_[a-z]/g,function(t){return t[1].toUpperCase()})]}),String.prototype.format.add("$",function(t,r){return t[r[0]]});
__m("Node",function(){function e(){for(var e=[],n=0;n<arguments.length;n++)n&&e.push("\n"),e.push(arguments[n]);console.error.apply(console,e),process.exit(1)}function n(n,r){void 0===r&&(r="work");var t;return function(){try{return t||(t=require(n))}catch(o){e('Please, install "{0}" for {1}.'.format(n,r),"> "+f.format({dirname:__dirname,name:n}))}}}function r(e){f=e}function t(e,n){if(e&&n){var r=a().usage(e);for(var t in n)r=r.options(t,n[t]);s=r.argv}return s}function o(){a().showHelp()}function i(e){return l().readFileSync(e,"utf-8")}function c(e,n){return l().writeFileSync(e,n,"utf-8")}function u(e){return p().resolve(__dirname,e)}var a,s,f,l,m,p;return{e:{get fs(){return l},get cp(){return m},get path(){return p},fatalError:e,safeAccess:n,setInstallCmd:r,args:t,showHelp:o,readFile:i,writeFile:c,resolve:u},v:function(){a=n("optimist","correct interact in shell"),f='cd "{0:@(DIRNAME)}" && npm install {0:@(NAME)}',l=n("fs"),m=n("child_process"),p=n("path")}}});
__m("App",function(){function e(e){if(!e)return null;var t=d.path().resolve(e);try{d.fs().mkdirSync(t)}catch(r){}return d.fs().existsSync(t)?t:null}function t(e){return/^(on|true|1|yes|enabled?)$/i.test(e)?!0:/^(off|false|0|no|disabled?)$/i.test(e)?!1:(d.fatalError('Wrong parameter value: "{0}".'.format(e)),void 0)}function r(e,t){function a(e,t,r,a){return e==r&&t==a||e==a&&t==r}var o={target:function(e,t){var r=e.value,o=t.value;return r==o?e:a(r,o,"web","web:onload")?{type:"target",value:"web:onload"}:a(r,o,"web","local")?{type:"target",value:"local"}:(d.fatalError('Incompatibile target: "{0}" and "{1}".'.format(r,o)),void 0)},buildTo:function(){return d.fatalError("Only one build-target instruction allowed.")}};if((void 0!==e||void 0!==t)&&"function"!=typeof e){if(void 0===e)return t;if(void 0===t)return e;if("boolean"==typeof e)return e||t;if("number"==typeof e)return e+t;if("function"==typeof e.concat&&"function"==typeof e.push)return e.concat(t);if(o[e.type])return o[e.type](t,e);if("function"==typeof e.substr)return t+"\n"+e;if("object"==typeof e){for(var n in e)e[n]=r(e[n],t[n]);for(var n in t)void 0===e[n]&&(e[n]=r(e[n],t[n]));return e}d.fatalError('Not implemented: "{0}".'.format(typeof e))}}function a(e){x||console.log(". "+e);var r=d.readFile(e);x||console.log(".. Readed");var a=u.work(r);x||console.log(".. Preworked");var o=c.work(a.code,e);x||console.log(".. Parsed");var n=f.work(o);x||console.log(".. Converted");var i=p.work(n.tree);x||console.log(".. Formatted");var s=[],l={code:i.code,additional:i.additional,modules:n.modules,lessParams:n.lessParams,hypParams:n.hypParams},g=!0;a.node&&(l.additional.target={type:"target",value:"node"});for(var h=0;h<i.jsx.length;h++){var b=i.jsx[h].key,m=i.jsx[h].value;if(null!==b)switch(b){case"import":s.push({name:m+(/(\/|\\)$/.test(m)?"*":"")+".jsxi"});break;case"include":s.push({name:m+(/(\/|\\)$/.test(m)?"*":""),raw:!0});break;case"compress":g=t(m);break;case"isolate":l.additional.isolate=t(m);break;case"modules-public":l.additional.modulesPublic=t(m);break;case"target":var y=["default","auto","node","web","web:onload","local"].indexOf(m);-1==y&&d.fatalError('Undefined target value: "{0}" (at {1}).'.format(m,e)),y>1&&(l.additional.target={type:"target",value:m});break;case"build-to":l.additional.buildTo={type:"buildTo",value:m};break;case"define":l.additional.defines||(l.additional.defines=[]);var j=m.match(/^([^\s]+)\s+([\s\S]+)$/);j||d.fatalError('Wrong define value: "{0}" (at {1}).'.format(m,e)),l.additional.defines.push({what:j[1].trim(),by:j[2].trim()});break;default:d.fatalError('Undefined instruction: "{0}" (at {1}).'.format(b,e))}else x||console.log("Warning: found unparcable Jsx comment ({0}).".format(e))}return g&&(l.code=v.work(l.code,e)),{result:l,childs:s}}function o(e,t,r){function a(t,a){void 0===a&&(a=r);var n=d.path().resolve(t,e);if(-1!==n.indexOf("*")){var i=[];if(E().sync(n).forEach(function(e){return i.push({file:e,top:a})}),i.length)return o=i}else if(d.fs().existsSync(n))return o=[{file:n,top:a}]}void 0===r&&(r=t);var o;if(a(t))return o;for(;t.length>r.length&&0==t.indexOf(r);){var n=d.path().dirname(t);if(n==t)break;if(a(t=n))return o}for(var i=0;i<w.length;i++){var s=w[i];if(a(s,s))return o}return null}function n(e,t,i){if(void 0===i&&(i={}),d.fs().existsSync(e)||d.fatalError("Divided by zero."),i.raw)return{code:d.readFile(e)};var s=h.load(e);s||(s=a(e,t),h.save(e,s));var l=[];s.childs.forEach(function(r){var a=o(r.name,d.path().dirname(e),t);a||d.fatalError('Couldn\'n found included file: "{0}" ({1}).'.format(r.name,e));for(var i=0;i<a.length;i++)-1==C.indexOf(a[i].file)&&(C.push(a[i].file),l.push(n(a[i].file,a[i].top,{raw:r.raw})))});for(var u=l.length-1;u>=0;u--)s.result=r(s.result,l[u]);return s.result}function i(e,t,r){var a=d.path().resolve(e,"..");return t&&(a=d.path().resolve(a,t)),(!t||/[\/\\]$/.test(t))&&(a=d.path().resolve(a,d.path().basename(e,".jsx")+(r?".php":".js"))),a}function s(e){var t=[],r=e.modules&&g.get(e.additional);e.additional.target&&"node"==e.additional.target.value&&t.push("#!/usr/bin/env node"),e.additional.php&&j&&(t.push("<? header('Content-Type: application/javascript') ?>"),x||console.log("PHP mode.")),e.additional.userscript&&t.push("// ==UserScript==\n"+e.additional.userscript.map(function(e){return"// @"+e.key+" "+e.value+"\n"}).join("")+"// ==/UserScript==\n"),e.additional.isolate&&t.push("(function (){\n"),r&&t.push(r.begin),e.lessParams&&t.push("String.prototype.less=function (a,r){r=this;for(var n in a)r=r.replace(new RegExp('@'+n.replace(/([a-z])([A-Z])/g,'$1_$2').toUpperCase()+'([^A-Z0-9_])','g'),a[n]+'$1');return r}"),t.push(e.code),r&&t.push(r.end),e.additional.isolate&&t.push("\n})()");var a=t.join("\n");if(e.additional.defines){var o=e.additional.defines;for(var n in o){var s=o[n];a=a.split(s.what).join(s.by)}}return{file:m||i(b,e.additional.buildTo&&e.additional.buildTo.value,e.additional.php&&j),code:a}}function l(){d.setInstallCmd("js-ext -i {0:@(NAME)}"),P()(function(t){d.args("Usage: js-ext file [flags]",{p:{alias:"php-header",description:"Use php header if nessesary."},o:{alias:"output",description:'Output file (else automode) or ":stdout".'},c:{alias:"cache",description:'Cache folder (else default) or ":no".'},i:{alias:"includes",description:'Folders (divided by ":") with included files.'},s:{alias:"setup",description:"Install missing part."},g:{alias:"gcc",description:"Use Google Closure Compiler for better compression and perfomance."},e:{alias:"expanded",description:"Prevent any compressing."},u:{alias:"usage",description:"This text."}});try{var t=d.args()._[0];b=d.path().resolve('"'==t[0]?t.slice(1,-1):t)}catch(r){}if(d.args().e?v.disable():d.args().g&&v.useClosure(),d.args().s){var a=d.cp().spawn("cmd",["/C","cd","/d",__dirname,"&&","npm","install","2>&1",d.args().i]);a.stdout.on("data",function(e){return process.stdout.write(e.toString())}),a.on("close",function(e){return console.log("NPM's job done"+(e?"(with {0} as result).".format(e):"."))})}else if(d.args().u||!b)d.showHelp();else if(d.fs().existsSync(b)){var o=d.args().c?d.args().c.trim():"";y=/^:no(ne|t)?$/i.test(o)?null:e(o||d.resolve("cache")),k=e(d.resolve("debug")),w=(d.args().i?d.args().i.split(":"):[]).concat([e(d.resolve("includes"))]),m=d.args().o,j=d.args().p,x=/^:(stdout|console)$/.test(m);var i=s(n(b));x?console.log(i.code):d.writeFile(i.file,i.code)}else d.fatalError('Input file "{0}" not found.'.format(b))}).run()}var d,u,c,f,p,v,g,h,b,m,y,j,w,k,x,C,E,P;return{e:{get inputFile(){return b},get outputFile(){return m},get cacheFolder(){return y},get argPhpHeader(){return j},get includesFolders(){return w},get debugFolder(){return k},get silenceMode(){return x}},i:l,g:function(){return["Node","Prework","Parser","Converter","Format","Compressor","ModulesCode","Cacher"]},s:function(e){d=e[0],u=e[1],c=e[2],f=e[3],p=e[4],v=e[5],g=e[6],h=e[7]},v:function(){C=[],E=d.safeAccess("glob","usings masks"),P=d.safeAccess("fibers")}}});
__m("Md5",function(){function r(r){return e(r)}function n(r){return o(r)}function t(r){return a(r)}function e(r){return u(h(i(r)))}function o(r){return c(h(i(r)))}function a(r,n){return f(h(i(r)),n)}function h(r){return l(C(g(r),8*r.length))}function u(r){try{}catch(n){b=0}for(var t,e=b?"0123456789ABCDEF":"0123456789abcdef",o="",a=0;a<r.length;a++)t=r.charCodeAt(a),o+=e.charAt(t>>>4&15)+e.charAt(15&t);return o}function c(r){try{}catch(n){x=""}for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e="",o=r.length,a=0;o>a;a+=3)for(var h=r.charCodeAt(a)<<16|(o>a+1?r.charCodeAt(a+1)<<8:0)|(o>a+2?r.charCodeAt(a+2):0),u=0;4>u;u++)e+=8*a+6*u>8*r.length?x:t.charAt(h>>>6*(3-u)&63);return e}function f(r,n){var t,e,o,a,h,u=n.length,c=Array(Math.ceil(r.length/2));for(t=0;t<c.length;t++)c[t]=r.charCodeAt(2*t)<<8|r.charCodeAt(2*t+1);var f=Math.ceil(8*r.length/(Math.log(n.length)/Math.log(2))),i=Array(f);for(e=0;f>e;e++){for(h=Array(),a=0,t=0;t<c.length;t++)a=(a<<16)+c[t],o=Math.floor(a/u),a-=o*u,(h.length>0||o>0)&&(h[h.length]=o);i[e]=a,c=h}var g="";for(t=i.length-1;t>=0;t--)g+=n.charAt(i[t]);return g}function i(r){for(var n,t,e="",o=-1;++o<r.length;)n=r.charCodeAt(o),t=o+1<r.length?r.charCodeAt(o+1):0,n>=55296&&56319>=n&&t>=56320&&57343>=t&&(n=65536+((1023&n)<<10)+(1023&t),o++),127>=n?e+=String.fromCharCode(n):2047>=n?e+=String.fromCharCode(192|n>>>6&31,128|63&n):65535>=n?e+=String.fromCharCode(224|n>>>12&15,128|n>>>6&63,128|63&n):2097151>=n&&(e+=String.fromCharCode(240|n>>>18&7,128|n>>>12&63,128|n>>>6&63,128|63&n));return e}function g(r){for(var n=Array(r.length>>2),t=0;t<n.length;t++)n[t]=0;for(var t=0;t<8*r.length;t+=8)n[t>>5]|=(255&r.charCodeAt(t/8))<<t%32;return n}function l(r){for(var n="",t=0;t<32*r.length;t+=8)n+=String.fromCharCode(r[t>>5]>>>t%32&255);return n}function C(r,n){r[n>>5]|=128<<n%32,r[(n+64>>>9<<4)+14]=n;for(var t=1732584193,e=-271733879,o=-1732584194,a=271733878,h=0;h<r.length;h+=16){var u=t,c=e,f=o,i=a;t=d(t,e,o,a,r[h+0],7,-680876936),a=d(a,t,e,o,r[h+1],12,-389564586),o=d(o,a,t,e,r[h+2],17,606105819),e=d(e,o,a,t,r[h+3],22,-1044525330),t=d(t,e,o,a,r[h+4],7,-176418897),a=d(a,t,e,o,r[h+5],12,1200080426),o=d(o,a,t,e,r[h+6],17,-1473231341),e=d(e,o,a,t,r[h+7],22,-45705983),t=d(t,e,o,a,r[h+8],7,1770035416),a=d(a,t,e,o,r[h+9],12,-1958414417),o=d(o,a,t,e,r[h+10],17,-42063),e=d(e,o,a,t,r[h+11],22,-1990404162),t=d(t,e,o,a,r[h+12],7,1804603682),a=d(a,t,e,o,r[h+13],12,-40341101),o=d(o,a,t,e,r[h+14],17,-1502002290),e=d(e,o,a,t,r[h+15],22,1236535329),t=v(t,e,o,a,r[h+1],5,-165796510),a=v(a,t,e,o,r[h+6],9,-1069501632),o=v(o,a,t,e,r[h+11],14,643717713),e=v(e,o,a,t,r[h+0],20,-373897302),t=v(t,e,o,a,r[h+5],5,-701558691),a=v(a,t,e,o,r[h+10],9,38016083),o=v(o,a,t,e,r[h+15],14,-660478335),e=v(e,o,a,t,r[h+4],20,-405537848),t=v(t,e,o,a,r[h+9],5,568446438),a=v(a,t,e,o,r[h+14],9,-1019803690),o=v(o,a,t,e,r[h+3],14,-187363961),e=v(e,o,a,t,r[h+8],20,1163531501),t=v(t,e,o,a,r[h+13],5,-1444681467),a=v(a,t,e,o,r[h+2],9,-51403784),o=v(o,a,t,e,r[h+7],14,1735328473),e=v(e,o,a,t,r[h+12],20,-1926607734),t=y(t,e,o,a,r[h+5],4,-378558),a=y(a,t,e,o,r[h+8],11,-2022574463),o=y(o,a,t,e,r[h+11],16,1839030562),e=y(e,o,a,t,r[h+14],23,-35309556),t=y(t,e,o,a,r[h+1],4,-1530992060),a=y(a,t,e,o,r[h+4],11,1272893353),o=y(o,a,t,e,r[h+7],16,-155497632),e=y(e,o,a,t,r[h+10],23,-1094730640),t=y(t,e,o,a,r[h+13],4,681279174),a=y(a,t,e,o,r[h+0],11,-358537222),o=y(o,a,t,e,r[h+3],16,-722521979),e=y(e,o,a,t,r[h+6],23,76029189),t=y(t,e,o,a,r[h+9],4,-640364487),a=y(a,t,e,o,r[h+12],11,-421815835),o=y(o,a,t,e,r[h+15],16,530742520),e=y(e,o,a,t,r[h+2],23,-995338651),t=m(t,e,o,a,r[h+0],6,-198630844),a=m(a,t,e,o,r[h+7],10,1126891415),o=m(o,a,t,e,r[h+14],15,-1416354905),e=m(e,o,a,t,r[h+5],21,-57434055),t=m(t,e,o,a,r[h+12],6,1700485571),a=m(a,t,e,o,r[h+3],10,-1894986606),o=m(o,a,t,e,r[h+10],15,-1051523),e=m(e,o,a,t,r[h+1],21,-2054922799),t=m(t,e,o,a,r[h+8],6,1873313359),a=m(a,t,e,o,r[h+15],10,-30611744),o=m(o,a,t,e,r[h+6],15,-1560198380),e=m(e,o,a,t,r[h+13],21,1309151649),t=m(t,e,o,a,r[h+4],6,-145523070),a=m(a,t,e,o,r[h+11],10,-1120210379),o=m(o,a,t,e,r[h+2],15,718787259),e=m(e,o,a,t,r[h+9],21,-343485551),t=M(t,u),e=M(e,c),o=M(o,f),a=M(a,i)}return Array(t,e,o,a)}function A(r,n,t,e,o,a){return M(S(M(M(n,r),M(e,a)),o),t)}function d(r,n,t,e,o,a,h){return A(n&t|~n&e,r,n,o,a,h)}function v(r,n,t,e,o,a,h){return A(n&e|t&~e,r,n,o,a,h)}function y(r,n,t,e,o,a,h){return A(n^t^e,r,n,o,a,h)}function m(r,n,t,e,o,a,h){return A(t^(n|~e),r,n,o,a,h)}function M(r,n){var t=(65535&r)+(65535&n),e=(r>>16)+(n>>16)+(t>>16);return e<<16|65535&t}function S(r,n){return r<<n|r>>>32-n}var b,x;return{e:{hex:r,b64:n,any:t},v:function(){b=0,x=""}}});
__m("Cacher",function(){function e(e){return i.path().resolve(c.cacheFolder,a.hex(e))}function n(e){var n=i.fs().statSync(e);return[o||"",+n.mtime,n.size].join("")}function r(r){if(c.cacheFolder)try{var t=e(r);if(i.fs().existsSync(t)){var a=JSON.parse(i.readFile(t));if(a.mark==n(r))return a.content}}catch(o){}}function t(r,t){c.cacheFolder&&i.writeFile(e(r),JSON.stringify({mark:n(r),content:t}))}var c,i,a,o;return{e:{load:r,save:t},g:function(){return["@App","Node","Md5"]},s:function(e){c=e[0],i=e[1],a=e[2]},v:function(){o=n(__filename)}}});
__m("Compressor",function(){function r(r){d?(i.writeFile(i.path().resolve(t.debugFolder,"compress-error.js"),code),console.error('Saved at: "'+i.path().resolve(t.cacheFolder,"compress-error.js")+'".')):console.error(code),i.fatalError("Compress error: {0}.".format(r),code)}function e(r){var e=require("util"),o=e.error;e.error=function(r){-1==r.indexOf("WARN: Dropping unused function argument arg")&&console.log("... "+r.replace(/^WARN/,"Warning"))};var n=u().minify(r,{fromString:!0,warnings:!t.silenceMode}).code;return e.error=o,n}function o(e){var o=f().current,n=e;try{a().compile(e,{},function(s,c,i){s?r(s,e):(!t.silenceMode&&i&&console.log(i),n=c.trim()),o.run()}),f().yield()}catch(s){i.fatalError("Compress error: {0} (please, check your JRE).".format(s))}return n}function n(r){return l?r:p?o(r):e(r)}function s(){l=!0}function c(){p=!0}var i,t,u,a,f,l,p,d;return{e:{work:n,disable:s,useClosure:c},g:function(){return["Node","@App"]},s:function(r){i=r[0],t=r[1]},v:function(){u=i.safeAccess("uglify-js","js compression"),a=i.safeAccess("closure-compiler","deep js compression"),f=i.safeAccess("fibers","deep js compression"),l=!1,p=!1,d=!0}}});
__m("Converter",function(){function e(e,t,n){return void 0===n&&(n=[]),{type:"PropertyAssignment",name:e,value:{type:"Function",name:null,params:n,elements:t}}}function t(e){if("object"==typeof e&&e){if(e.indexOf){for(var n=[],a=0;a<e.length;a++)n.push(t(e[a]));return n}if(f[e.type])return f[e.type](e);var n={};for(var r in e)n[r]=t(e[r]);return n}return e}function n(e){return o=!1,m=!1,c=!1,{tree:t(e),modules:!!o,lessParams:!!m,hypParams:!!c}}function a(e){for(var t in shameOnMeDogNail){var n=shameOnMeDogNail[t],a=n();if(!a)return null;e=e.replace(t,a)}return e}var r,i,s,l,u,p,o,m,c,f;return{e:{work:n,finish:a},g:function(){return["Node"]},s:function(e){r=e[0]},v:function(){i="__m",s=r.safeAccess("minimize","compress html"),l=r.safeAccess("less","converting less to css"),u=r.safeAccess("fibers","converting less to css"),f={Function:function(e){var n=[];return{type:"Function",name:e.name,exportFlag:e.exportFlag,params:e.params.map(function(e){return e&&"IdentifierWithDefault"==e.type?(n.push({type:"IfStatement",condition:{type:"BinaryExpression",operator:"===",left:{type:"Variable",name:e.identifier},right:{type:"Variable",name:"undefined"}},ifStatement:{type:"ExpressionStatement",value:{type:"AssignmentExpression",operator:"=",left:{type:"Variable",name:e.identifier},right:t(e.value)}},elseStatement:null}),e.identifier):e}),elements:n.length?n.concat(t(e.elements)):t(e.elements)}},Lambda:function(e){return f.Function({type:"Function",name:null,params:0==e.params.length?["arg"]:e.params,elements:"Block"==e.element.type?e.element.statements:["ExpressionStatement"==e.element.type?{type:"ReturnStatement",value:t(e.element.value)}:e.element]})},StringLiteral:function(e,t){function n(e){var n,a=u().current;try{new(l().Parser)({paths:[r.path().dirname(t),r.resolve("includes")],filename:t}).parse('@import "__js_ext_utils.less";\n'+e,function(e,t){e&&r.fatalError("Error at LESS parsing:",e),n=t.toCSS({compress:!0}),a.run()})}catch(i){r.fatalError("Error at LESS parsing: ",i)}return u().yield(),n}var a;switch((e.special||"").match(/^[a-z]*/)[0]){case"h":var i=e.value.replace(/<([a-z]+)(\s[^>]+?)?\s*\/>/g,"<$1$2></$1>");p||(p=new(s())({empty:!0,cdata:!0,comments:!1,spare:!0,quotes:!0})),p.parse(i,function(e,t){return a=t});break;case"c":a=e.value.replace(/\s+/g," ").replace(/\s*([{};:])\s*/g,"$1").trim();break;case"s":a=e.value.replace(/\s+/g," ").trim();break;case"l":a=n(e.value);break;case"lp":var o={},c=e.value;m=!0;var f={def:function(){return 1e4*(1+Math.random())|0},size:function(){return this.def()+"px"},radius:function(){return this.size()},per:function(){return this.def()+"%"},time:function(){return this.def()+"s"},color:function(){return"#"+(15728639*Math.random()+1048576|0).toString(16)},text:function(){return'"'+(1e18*Math.random()).toString(32)+'"'},font:function(){return this.text()}};a=n(c.replace(/@([A-Z0-9_]+?)(?:_([A-Z]+))?([^A-Z0-9_])/g,function(e,t,n,a){var r="@"+t+(n?"_"+n:""),i=o[r];if(!i){var s=f[n]||f.def;do i=s();while(-1!=c.indexOf(i));o[r]=i}return i+a}));for(var y in o){var v=o[y];a=a.split(v).join(y)}break;default:a=e.value}return{type:"StringLiteral",value:a}},Module:function(n){o=!0;for(var a=[],r=[],s=[],l=[],u=[],p=!1,m=0;m<n.elements.length;m++){var c=n.elements[m];if("ImportStatement"===c.type)u.push({type:"VariableStatement",declarations:function(e){for(var t=0;t<e.length;t++){var n="@"===e[t][0]?e[t].slice(1):e[t];a.push({type:"StringLiteral",value:e[t]}),r.push({type:"ExpressionStatement",value:{type:"AssignmentExpression",operator:"=",left:{type:"Variable",name:n},right:{type:"PropertyAccess",base:{type:"Variable",name:"__"},name:{type:"NumericLiteral",value:r.length}}}}),e[t]={type:"VariableDeclaration",name:n,value:null}}return e}(t(c.declarations))});else{var f=t(c);if("Function"==f.type&&"init"==f.name)p=!0;else if("Function"===f.type&&f.exportFlag)s.push({type:"PropertyAssignment",name:f.name,value:{type:"Variable",name:f.name}});else if("VariableStatement"===f.type)for(var y=0;y<f.declarations.length;y++)f.exportFlag&&s.push({type:"GetterDefinition",name:f.declarations[y].name,body:[{type:"ReturnStatement",value:{type:"Variable",name:f.declarations[y].name}}]}),null!==f.declarations[y].value&&(l.push({type:"ExpressionStatement",value:{type:"AssignmentExpression",operator:"=",left:{type:"Variable",name:f.declarations[y].name},right:t(f.declarations[y].value)}}),f.declarations[y].value=null);u.push(f)}}return s=s.length?[{type:"PropertyAssignment",name:"e",value:{type:"ObjectLiteral",properties:s}}]:[],p&&s.push({type:"PropertyAssignment",name:"i",value:{type:"Variable",name:"init"}}),a.length&&s.push(e("g",[{type:"ReturnStatement",value:{type:"ArrayLiteral",elements:a}}]),e("s",r,["__"])),l.length&&s.push(e("v",l)),u.push({type:"ReturnStatement",value:{type:"ObjectLiteral",properties:s}}),{type:"ExpressionStatement",value:{type:"FunctionCall",name:{type:"Variable",name:i},arguments:[{type:"StringLiteral",value:t(n.identifier)},{type:"Function",name:null,params:[],elements:u}]}}}}}}});
__m("Format",function(){function t(){o={},a=[]}function e(t,e){"jsx"==t||o[t]?[].push.apply(o[t]||a,e):o[t]=e}function n(e){return t(),{code:l(e).trim(),additional:o,jsx:a}}var r,i,o,a,u,c,l,s;return{e:{work:n},g:function(){return["Node"]},s:function(t){r=t[0]},v:function(){i="\n",u=+new Date%100,c=function(){return"_"+Math.round(1e10*Math.random()).toString(32)+"_"+u++},l=function(t){return s[t.type]?s[t.type](t):(r.fatalError("No formatter for type: "+t.type,t),void 0)},s={Program:function(t){return t.elements.map(l).join(i)},Raw:function(t){return t.value},SpecialComment:function(t){return e(t.tag,t.value)||""},NumericLiteral:function(t){return t.value},UnaryExpression:function(t){return t.operator+" "+l(t.expression)},BinaryExpression:function(t){return l(t.left)+" "+t.operator+" "+l(t.right)},ConditionalExpression:function(t){return l(t.condition)+" ? "+l(t.trueExpression)+" : "+l(t.falseExpression)},ParenthesizedExpression:function(t){return"("+l(t.value)+")"},VariableStatement:function(t){return"var "+t.declarations.map(l).join(", ")+";"},VariableDeclarations:function(t){return"var "+t.declarations.map(l).join(", ")},VariableDeclaration:function(t){return t.value?t.name+" = "+l(t.value):t.name},FunctionCall:function(t){return l(t.name)+" ("+t.arguments.map(l).join(", ")+")"},Function:function(t){return"function"+(t.name?" "+t.name:"")+" ("+t.params.join(",")+"){"+i+t.elements.map(l).join(i)+i+"}"},StringLiteral:function(t){return JSON.stringify(t.value)},BooleanLiteral:function(t){return t.value?"true":"false"},NullLiteral:function(){return"null"},Variable:function(t){return t.name},PropertyAccess:function(t){return l(t.base)+(t.name.type?" ["+l(t.name)+"]":"."+t.name)},IfStatement:function(t){return"if ("+l(t.condition)+")"+i+l(t.ifStatement)+(t.elseStatement?i+"else"+i+l(t.elseStatement):"")},Block:function(t){return"{"+i+t.statements.map(l).join(i)+i+"}"},ReturnStatement:function(t){return t.value?"return "+l(t.value)+";":"return;"},EmptyStatement:function(){return";"},ExpressionStatement:function(t){return l(t.value)+";"},AssignmentExpression:function(t){return l(t.left)+" "+t.operator+" "+l(t.right)},PostfixExpression:function(t){return l(t.expression)+t.operator},ArrayLiteral:function(t){return"["+t.elements.map(l).join(",")+"]"},ObjectLiteral:function(t){return"{"+t.properties.map(l).join(",")+"}"},RegularExpressionLiteral:function(t){return"/"+t.body+"/"+t.flags},This:function(){return"this"},ThrowStatement:function(t){return"throw "+l(t.exception)+";"},ForStatement:function(t){return"for ("+(t.initializer?l(t.initializer):"")+"; "+i+(t.test?l(t.test):"")+"; "+(t.counter?l(t.counter):"")+")"+i+l(t.statement)},ForInStatementExt:function(t){if("in-array"==t.token){var e=!t.collection||"Variable"!=t.collection.type,n=e?c():l(t.collection);if(t.value){if(!t.iterator.name)throw new Error("Not implemented.");return(e?"{ var "+n+" = "+l(t.collection)+"; ":"")+"for (var "+l(t.iterator)+" = 0; "+t.iterator.name+" < "+n+".length; "+t.iterator.name+" ++){"+i+"var "+l(t.value)+" = "+n+"["+t.iterator.name+"];"+i+(t.statement&&"Block"==t.statement.type?l(t.statement).slice(1,-1).trim():l(t.statement))+i+"}"+(e?"}":"")}var r=c();return(e?"{ var "+n+" = "+l(t.collection)+"; ":"")+"for (var "+r+" = 0; "+r+" < "+n+".length; "+r+" ++){"+i+"var "+l(t.iterator)+" = "+n+"["+r+"];"+i+(t.statement&&"Block"==t.statement.type?l(t.statement).slice(1,-1).trim():l(t.statement))+i+"}"+(e?"}":"")}if(t.value){var e=!t.collection||"Variable"!=t.collection.type,n=e?c():l(t.collection);return(e?"{ var "+n+" = "+l(t.collection)+"; ":"")+"for (var "+l(t.iterator)+" in "+n+"){"+i+"var "+l(t.value)+" = "+n+"["+l(t.iterator)+"];"+i+(t.statement&&"Block"==t.statement.type?l(t.statement).slice(1,-1).trim():l(t.statement))+i+"}"+(e?"}":"")}return"for (var "+l(t.iterator)+" in "+l(t.collection)+")"+i+l(t.statement)},WhileStatement:function(t){return"while ("+l(t.condition)+")"+i+l(t.statement)},DoWhileStatement:function(t){return"do"+i+l(t.statement)+i+" while ("+l(t.condition)+");"},SwitchStatement:function(t){return"switch ("+l(t.expression)+"){"+i+t.clauses.map(l).join(i)+i+"}"},CaseClause:function(t){return"case "+l(t.selector)+":"+i+t.statements.map(l).join(i)},DefaultClause:function(t){return"default:"+t.statements.map(function(t){return l(t)}).join(" ")},BreakStatement:function(t){return t.label?"break "+t.label+";":"break;"},ContinueStatement:function(t){return t.label?"continue "+t.label+";":"continue;"},TryStatement:function(t){return"try"+("Block"==t.block.type?l(t.block):"{"+i+l(t.block)+i+"}")+(t["catch"]?l(t["catch"]):"")+(t["finally"]?l(t["finally"]):"")+(t["catch"]||t["finally"]?"":"catch (e){}")},Catch:function(t){return"catch ("+t.identifier+")"+("Block"==t.block.type?l(t.block):"{"+i+l(t.block)+i+"}")},Finally:function(t){return"finally"+("Block"==t.block.type?l(t.block):"{"+i+l(t.block)+i+"}")},PropertyAssignment:function(t){return JSON.stringify(t.name)+":"+l(t.value)},NewOperator:function(t){return"new "+l(t.constructor)+"("+t.arguments.map(l).join(", ")+")"},GetterDefinition:function(t){return"get "+t.name+" (){"+t.body.map(l).join(i)+"}"},SetterDefinition:function(t){return"set "+t.name+" ("+t.param+"){"+t.body.map(l).join(i)+"}"},LabelledStatement:function(t){return t.label+":"+l(t.statement)},WithStatement:function(t){return"with ("+l(t.environment)+"){"+i+l(t.statement)+i+"}"},PhpLiteral:function(t){return o.php=!0,'/*!<? echo "*"."/"; include "'+t.value+'"; echo "||/*" ?>*/ null'}}}}});
__m("ModulesCode",function(){function i(i){var t=i.target&&i.target.value,e={root:/^web/.test(t)?"window":/^node$/.test(t)?"GLOBAL":/^local$/.test(t)?"0":'"u" != (typeof window)[0] && window || GLOBAL',end:"web:onload"==t?"'u' != (typeof window)[0] && 'u' != (typeof document)[0] && !/loaded|complete/.test(document.readyState) ? window.addEventListener('load', __m) : __m()":"__m()",main:i.modulesPublic?'if (m){ s [i] = m (); } else if (typeof i == \'string\'){ if (!w) throw "Not initialized yet!"; return s [i].e; } else if (!w){ for (i in s) if (G (i).g) G (i).s (G (i).g ().map (function (i){ return G ("@" == i [0] ? i.slice (1) : i).e || {} })); for (i in s) I (i); w = true; }':'if (m){ s [i] = m (); } else { for (i in s) if (G (i).g) G (i).s (G (i).g ().map (function (i){ return G ("@" == i [0] ? i.slice (1) : i).e || {} })); for (i in s) I (i); {0} }',mainHelper:i.modulesPublic?", w = 0":""};return e.rootExists="0"!=e.root?"root.":"",e.local="0"!=e.root?"":"var __m;",e.main=e.main.format("0"!=e.root?"delete root.__m":""),{begin:o.work('{0:@(LOCAL)}(function (){ var s = {}, root = {0:@(ROOT)}{0:@(MAIN_HELPER)}; function G (i) { if (s [i]) return s [i]; throw "Not found: " + i; } function I (i) { var m = G (i); if (!m._d){ m._a = 1; if (m.g) m.g ().forEach (function (other){ if ("@" != other [0]) { if (G (other)._a) throw "Cycle: " + i + ", " + other; if (!G (other)._d) I (other); } }); if (m.v) m.v (); if (m.i) m.i (); m._d = 1; delete m._a; } } {0:@(ROOT_EXISTS)}__m = function (i, m) { {0:@(MAIN)} } })();'.format(e)),end:o.work("{0:@(END)}".format(e))}}var o;return{e:{get:i},g:function(){return["Compressor"]},s:function(i){o=i[0]}}});
__m("Parser",function(){function r(r,e){try{return a.parse(r)}catch(t){n.fatalError('Error while parsing "{0}": {1}'.format(e,t),t.stack)}}function e(){n.fs().existsSync(o)||n.fatalError("Parser not found.");try{a=require(o)}catch(r){}a&&"function"==typeof a.parse||n.fatalError("Parser is broken.")}var n,t,o,a;return{e:{work:r},i:e,g:function(){return["Node","Compressor"]},s:function(r){n=r[0],t=r[1]},v:function(){o=n.resolve(__filename.replace(/\.js$/,".parser"))}}});
__m("Prework",function(){function n(n){return"#!"==n.substr(0,2)?{code:n.substr(n.indexOf("\n")+1),node:!0}:{code:n}}return{e:{work:n}}});

__m();